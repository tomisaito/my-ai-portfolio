---
:globe_with_meridians: **Languages** | [English](./README.md) | [日本語](./README_JP.md)
---

# 手のジェスチャー分類器（Hand Gesture Classifier）

### ドメイン知識を考慮した画像分類における、データ中心（Data-Centric）のケーススタディ

> **要約 (TL;DR)**
> * **課題**: わずか 150 枚の自作画像という極めて小規模なデータセットで、いかに堅牢なジェスチャー分類器を構築するか。
> * **解決策**: センタークロップによる指先の欠損を避けるための「レターボックスパディング」の採用と、物理法則（フレミングの法則）に基づいた「左右反転の禁止」というデータ中心のアプローチを徹底。
> * **結果**: 「データセットの規模よりも、設計上の意思決定が性能を左右する」ことを証明し、テスト精度 96.67% を達成。

## 概要（Overview）

本プロジェクトは、3つの特定の**左手ジェスチャー**を認識するために設計された、深層学習ベースの画像分類モデルです。
このリポジトリは、単に大規模なデータセットやデプロイに焦点を当てるのではなく、**ドメイン知識とデータの品質がモデルの性能にどれほど直接的な影響を与えるか**を、現実世界の小規模なデータセットを用いて検証した**データ中心のケーススタディ**として機能します。

---

## プロジェクトの目標（Project Goal）

本プロジェクトの主眼は、複雑なアーキテクチャの提示やプロダクション環境へのデプロイ**ではありません**。
むしろ、**ドメインの制約を無視した標準的な前処理やデータ拡張が、いかにして静かにモデルを破綻させるか**を実証することにあります。

本プロジェクトでは以下の点に注力しています：

* ドメイン知識をどのようにデータ前処理に反映させるべきか
* なぜ一般的なデータ拡張の前提が、時に無効となるのか
* 注意深く構築されたデータセットが、いかにしてデータサイズの限界を補うことができるか

---

## 問題の定義（Problem Definition）

### ターゲットクラス（Target Classes）

モデルは以下の**3つの左手ジェスチャー**を分類します。

* Open Palm（パー）
* Thumbs Up（グッド）
* Fleming's Left Hand Rule（フレミング左手の法則）

**重要な制約：**
すべてのジェスチャーは**向きに敏感（Orientation-sensitive）であり、かつ左手限定**です。
鏡像（右手のジェスチャー）は意味的に異なり、同等として扱ってはなりません。

---

## データセットの構築（Dataset Construction）

### データの収集と所有権

本プロジェクトで使用されるすべての画像は、**著者自身によって収集されたもの**です。
外部のデータセットに頼ることなく、データの収集、ラベル付け、クリーニングをすべて手作業で行いました。

このアプローチにより、データ品質を完全にコントロールし、自身の観察に基づいた設計判断を下すことが可能になりました。

### データセットの構成

* **合計サンプル数**：150枚（3クラス）
* トレーニングセット：120枚
* バリデーションセット：30枚


* **被写体**：5名の異なる人物の手
* **背景**：少なくとも3種類の異なる背景
* **照明条件**：明るい環境と暗い環境をバランスよく配置

### 設計の意図

小規模なデータセットであっても、以下の要素への過学習を抑えるように意図的に構築されています。

* 特定の手の形
* 特定の背景
* 固定された照明条件

この多様性を導入することで、現実的な使用シナリオにおける堅牢性を向上させています。

---

## 主な設計上の判断（Key Design Decisions）

### 1. センタークロップの代わりにレターボックスパディングを採用

#### 課題（Problem）

標準的な**センタークロップ**を用いた初期の実験では、スマートフォンのアスペクト比の影響により、重要な情報である「指先」が切り取られてしまう現象が発生しました。これにより、ジェスチャーの表現が曖昧になっていました。

#### 解決策（Solution）

アスペクト比を維持したまま224×224にリサイズする**レターボックスパディング（Letterbox Padding）**を適用しました。

#### 影響（Impact）

* 手の全体的な幾何学構造が保持された
* ジェスチャーの識別に不可欠な指先の特徴が保存された
* 指先の欠損によるラベルの曖昧さが解消された

---

### 2. 物理法則を考慮したデータ拡張

#### 課題（Problem）

**左右反転（Horizontal Flip）のような一般的な拡張手法は、鏡像になってもラベルが不変であることを前提としています。しかし、本タスクにおいて左手を反転させると右手のジェスチャー**になり、意味的に誤ったものとなります。

#### 意思決定（Decision）

* 左右反転を**明示的に無効化**
* 適用する拡張を以下に限定：
* 回転（Rotation）
* 明るさのゆらぎ（Brightness jitter）
* ズーム（Zoom）



#### 根拠（Rationale）

データ拡張は単なる統計的な多様性のためではなく、**物理的および意味的な制約**を尊重しなければなりません。

---

### 3. 小規模データ戦略（Small-Data Strategy）

* **バックボーン**：ResNet18（転移学習）
* **動機**：過学習を最小限に抑えつつ、学習済みの視覚的特徴を活用する
* **結果**：テスト精度 **96.67%** を達成

この結果は、設計上の前提が正しければ、**データの品質とタスクの定式化がデータセットのサイズを凌駕し得る**ことを示唆しています。

---

## モデルアーキテクチャ（Model Architecture）

* **バックボーン**：ResNet18（学習済みモデル）
* **フレームワーク**：PyTorch
* **入力**：224×224 RGB画像
* **出力**：3クラス分類

---

## 既知の制限事項とエラー分析（Known Limitations and Error Analysis）

高い全体精度を達成している一方で、モデルは時折 **Open Palm** と **Fleming's Left Hand** を混同することがあります。

### 観察されたパターン

* **Open Palm** において親指と人差し指の角度が **Fleming's Left Hand** の幾何学的形状と酷似している場合に誤判定が発生しやすい。
* 複雑、あるいは学習データにない背景が含まれる場合に予測の不確実性が高まる。

### 推定される原因

* 2つのクラス間における、指の角度という幾何学的な類似性
* 小規模データセットゆえの背景の多様性の限界

これらの観察結果は、さらなる改善のために以下が必要であることを示しています。

* より精細なジェスチャーの定義
* 判定の難しいエッジケースに焦点を当てた追加データの収集

---

## （オプション）ローカルでのデモ実行

本リポジトリには、対話的なテストのための最小限の **GradioベースのUI** が含まれています。

> 注：デモの実行はオプションです。
> 本プロジェクトの本来の価値は、上述の設計根拠とデータ中心の意思決定にあります。

### セットアップ

```bash
pip install -r requirements.txt

```

### 起動

```bash
python app.py

```

起動後、ブラウザウィンドウが開き、左手のジェスチャー画像をアップロードしてモデルの予測を確認できます。

---

## テスト（Testing）

### 1. 手動テスト（Gradio UI）
サンプル画像を使ってモデルの動作を確認するには：

1. アプリを起動：`python app.py`
2. ブラウザで **http://127.0.0.1:7860** を開く
3. `test_images/` ディレクトリ内のサンプル画像（例：`thumbs_up.jpg`）をアップロードして判定結果を確認してください。

※プライバシー保護のため、サンプル画像は224x224pxにリサイズされています。

### 2. 自動テスト
スクリプトの整合性を検証するには：

```bash
pytest tests/test_model.py
```

---

## 環境（Environment）

* **フレームワーク**：PyTorch
* **UI**：Gradio
* **開発プラットフォーム**：Google Colab

---

## 結論（Takeaway）

本プロジェクトを通じて、以下のことが実証されました。

* データの前処理は単なる作業ではなく、モデルに影響を与える重要なステップである
* ドメイン知識に基づいてデータ拡張の手法を選択しなければならない
* 前提条件が明示的かつ妥当であれば、小規模なデータセットでも強力な結果を得ることができる

本システムにおける最も重要な要素は**モデルそのものではなく、トレーニングを開始する前に行われた意思決定**です。

---